<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OOBJECTIF R1P</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #0a0f1c;
            color: white;
            height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal {
            background: rgba(15,23,42,0.98);
            padding: 40px;
            border-radius: 20px;
            width: 380px;
            text-align: center;
            border: 1px solid #F7931E;
        }
        input {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            border: none;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 1.2rem;
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: #F7931E;
            color: black;
            border: none;
            padding: 16px 40px;
            border-radius: 9999px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
        }
        #main-app { display: none; }
    </style>
</head>
<body>

    <!-- MODAL LOGIN -->
    <div id="login-modal" class="modal">
        <h2>Bienvenue dans OOBJECTIF R1P</h2>
        <p>Entre ton prénom exactement comme dans l’équipe :</p>
        <input id="prenom-input" type="text" placeholder="Sofia, Kevin, Merwan..." />
        <button onclick="validatePrenom()">COMMENCER L’AVENTURE</button>
        <p id="login-error" style="color:#ff6666; margin-top:15px;"></p>
    </div>

    <!-- APP PRINCIPALE -->
    <div id="main-app">
        <h1 style="text-align:center; font-size:3rem;">Bienvenue <span id="user-name"></span> !</h1>
        <p style="text-align:center; font-size:1.4rem;">Équipe : <strong id="user-team"></strong></p>
        <button onclick="takeR1P()" style="margin:30px auto; display:block; padding:20px 50px; font-size:1.5rem;">R1P +1</button>
    </div>

    <script>
        const SUPABASE_URL = "https://ydcfjlogsbkmzzzkxvgo.supabase.co";
        const SUPABASE_ANON_KEY = "sb_publishable_zVqdL4T9-J9srWE88bAskQ_Pjqb75Fz";

        const supabase = Supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        const TEAM_MAP = {
            "sofia":"Caen", "david":"Caen", "kevin":"Caen",
            "durmus":"Evreux", "merwan":"Courbevoie",
            "diassivi":"Courbevoie", "sertag":"Courbevoie", "roxanne":"Rouen"
        };

        function validatePrenom(){
            let prenom = document.getElementById("prenom-input").value.trim().toLowerCase();
            
            if (!TEAM_MAP[prenom]) {
                document.getElementById("login-error").textContent = "Prénom non reconnu.";
                return;
            }

            const name = prenom.charAt(0).toUpperCase() + prenom.slice(1);
            document.getElementById("user-name").textContent = name;
            document.getElementById("user-team").textContent = TEAM_MAP[prenom];

            // Masquer le modal et afficher l'app
            document.getElementById("login-modal").style.display = "none";
            document.getElementById("main-app").style.display = "block";

            console.log("✅ Connexion réussie avec", name);
        }

        function takeR1P(){
            alert("R1P +1 validé pour " + document.getElementById("user-name").textContent + " !");
            // Ici tu pourras ajouter le vrai code Supabase plus tard
        }

        // Focus automatique sur l'input
        window.onload = () => document.getElementById("prenom-input").focus();
    </script>
</body>
</html>
